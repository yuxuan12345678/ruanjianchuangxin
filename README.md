# ruanjianchuangxin
高德地图API深度集成 · MCP框架支持的旅游计划一键可视化生成工具
# 旅游计划一键可视化生成工具（AMAP MCP Server）

<div align="right">

[English](README_EN.md) | 中文

</div>

> 本项目基于高德地图API开发，旨在为用户提供便捷的旅游计划一键可视化生成服务（by [开发者姓名]）。

这是一款基于Python和FastMCP开发的旅游计划一键可视化生成工具，作为MCP Server，可通过特定配置接入MCP Client（如Claude for Desktop），帮助用户自动完成旅游计划的生成与可视化展示，包括获取城市信息、天气情况、景点和美食推荐以及路线规划等操作。

## 主要特点与优势

- **深度集成地图与天气数据**：利用高德地图API获取准确的地理信息、景点美食数据和天气预报，为旅游计划提供全面支持。
- **模块化设计**：将功能分为城市信息获取、天气查询、景点美食搜索、路线规划和可视化展示等独立模块，提高代码可维护性。
- **智能解析用户输入**：自动解析用户输入的城市和天数信息，快速生成个性化的旅游攻略。
- **可视化输出**：将生成的旅游攻略渲染为美化的HTML页面，支持打印，方便用户查看和分享。

## 一、核心功能

### 1. 城市信息获取
- **城市代码查询**：通过高德地图地理编码API获取用户指定城市的名称和城市代码。

### 2. 天气查询
- **天气预报获取**：根据城市代码获取指定城市未来1 - 7天的天气预报信息。

### 3. 景点和美食搜索
- **景点推荐**：搜索指定城市的风景名胜，并返回景点名称、地址和评分等信息。
- **美食推荐**：搜索指定城市的餐饮服务场所，并返回美食名称、地址、类型和电话等信息。

### 4. 路线规划
- **路线建议生成**：根据景点和美食的位置信息，规划合理的出行路线，支持公交、驾车和步行三种模式。

### 5. 旅游计划生成与可视化
- **旅游攻略生成**：根据用户输入的城市和天数，结合天气、景点、美食和路线信息，生成详细的旅游攻略。
- **可视化展示**：将生成的旅游攻略渲染为美化的HTML页面，并保存到桌面，支持打印。

## 二、安装步骤

1. **Python 环境准备**：确保系统已安装 Python 3.8 或更高版本。若未安装，可从 Python 官方网站下载并安装。

2. **项目获取**：将本项目克隆或下载到本地。

3. **创建虚拟环境**：在项目目录下创建并激活虚拟环境（推荐）：
   ```bash
   # 创建虚拟环境
   python3 -m venv venv
   
   # 激活虚拟环境
   # Windows
   venv\Scripts\activate
   # macOS/Linux
   source venv/bin/activate
   ```

4. **安装依赖**：在激活的虚拟环境中安装所需依赖：
   ```bash
   pip install -r requirements.txt
   pip install fastmcp
   ```

## 三、MCP Server 配置

在 MCP Client（如Claude for Desktop）的配置文件中添加以下内容，将本工具配置为 MCP Server：

### Windows 配置示例

```json
{
    "mcpServers": {
        "amap": {
            "command": "python",
            "args": [
                "C:\\Users\\15742\\Desktop\\软件创新\\旅游助手\\travel_mcp_service.py",
                "--stdio"
            ]
        }
    }
}
```

> **重要提示**：
> - 请使用虚拟环境中Python解释器的**完整绝对路径**
> - 同样，travel_mcp_service.py也需要使用**完整绝对路径**
> - Windows路径中的反斜杠在JSON中需要双重转义（使用 `\\`）

### Python 命令区分（python 与 python3）

不同系统环境中，Python 命令可能有所不同，这取决于您的系统配置。以下是如何确定您应该使用哪个命令：

1. **确定您的 Python 命令**：
   - 在终端中运行：`python --version` 和 `python3 --version`
   - 查看哪个命令返回 Python 3.x 版本（本项目需要 Python 3.8+）

2. **在虚拟环境中确认**：
   - 激活虚拟环境后，运行 `which python` 或 `where python`（Windows）
   - 这将显示 Python 解释器的完整路径

3. **配置中使用正确的命令**：
   - Mac：通常为 `python3` 或虚拟环境中的 `python`
   - Windows：通常为 `python` 或 `python.exe`

在配置文件中，始终使用虚拟环境中 Python 解释器的**完整绝对路径**，而不是命令名称。

## 四、使用方法

### （一）启动服务器

1. **直接运行**：在项目目录下，激活虚拟环境后执行：
   ```bash
   python travel_mcp_service.py
   ```

2. **通过 MCP Client 启动**：配置好MCP Client后，按照客户端的操作流程进行启动和连接。

### （二）主要功能操作

在MCP Client（如Claude for Desktop）中连接到服务器后，可以使用以下功能：

### 1. 生成旅游计划

**工具函数**：
```
visualize_travel_itinerary(query="城市天数游")
```

**在MCP客户端中的使用方式**：
发送包含城市和天数的请求：
```
帮我生成一份北京3日游的旅游计划
```

**功能说明**：根据用户输入的城市和天数，生成详细的旅游攻略，并将其渲染为美化的HTML页面保存到桌面。

## 四、使用指南

### 0. 工作原理

本工具采用以下流程实现旅游计划的一键可视化生成：

1. **用户输入解析**：解析用户输入的城市和天数信息。
2. **数据获取**：通过高德地图API获取城市信息、天气情况、景点和美食推荐以及路线规划等数据。
3. **旅游攻略生成**：根据获取的数据，生成详细的旅游攻略文本。
4. **可视化展示**：将生成的旅游攻略渲染为美化的HTML页面，并保存到桌面。

### 1. 在MCP客户端中的使用方式

#### 基本操作

| 功能 | 示例命令 |
|---------|----------|
| **生成旅游计划** | `帮我生成一份[城市][天数]日游的旅游计划` |

### 2. 实际工作流程示例

```
用户: 帮我生成一份上海2日游的旅游计划

Claude: 我会帮您生成一份上海2日游的旅游计划。
[调用visualize_travel_itinerary工具]

Claude: ✅ 攻略已生成并保存到桌面：
C:\Users\username\Desktop\Travel_Plan_20240101_120000.html
```

### 3. 工作原理

本旅游计划一键可视化生成工具采用了模块化设计，分为以下核心模块：

1. **数据获取模块**：负责与高德地图API进行交互，获取城市信息、天气情况、景点和美食推荐以及路线规划等数据。
2. **旅游攻略生成模块**：根据获取的数据，生成详细的旅游攻略文本。
3. **可视化展示模块**：将生成的旅游攻略渲染为美化的HTML页面，并保存到桌面。

## 五、代码结构

- **travel_mcp_service.py**：实现主要功能的核心文件，包含城市信息获取、天气查询、景点美食搜索、路线规划和可视化展示等功能的代码逻辑。
- **requirements.txt**：记录项目所需的依赖库。

## 六、常见问题与解决方案

1. **连接失败**：
   - 确保使用了虚拟环境中Python解释器的**完整绝对路径**
   - 确保MCP服务器正在运行
   - 尝试重启MCP服务器和客户端

2. **数据获取问题**：
   - 检查高德地图API密钥是否正确
   - 检查网络连接是否正常
   - 查看API调用是否超出限制

3. **文件保存问题**：
   - 确保桌面目录有写入权限
   - 检查文件名是否包含非法字符

## 七、注意事项与问题解决

### 1. 使用注意事项

- **API密钥安全**：请妥善保管高德地图API密钥，避免泄露。
- **数据准确性**：本工具的数据来源于高德地图API，数据准确性可能受到API更新和网络状况的影响。
- **使用频率限制**：请遵守高德地图API的使用频率限制，避免因过度调用导致账号被封禁。

### 2. 常见问题与解决方案

#### API调用失败

如果遇到API调用失败的问题，可能是API密钥无效或调用频率超出限制，请尝试：

- 检查API密钥是否正确
- 查看API调用日志，确认是否超出限制
- 联系高德地图客服解决问题

#### 文件保存失败

如果遇到文件保存失败的问题，可能是桌面目录没有写入权限或文件名包含非法字符，请尝试：

- 检查桌面目录的权限设置
- 确保文件名不包含非法字符
- 尝试更改保存路径

## 八、免责声明

本工具仅用于学习和研究目的，使用者应严格遵守相关法律法规以及高德地图的使用规定。因使用不当导致的任何问题，本项目开发者不承担任何责任。
